<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign In / Sign Up - JB Creations</title>
    
    <!-- Critical CSS - Inline for performance -->
    <link rel="preload" href="style.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="style.css"></noscript>
    
    <!-- Performance optimization files -->
    <link rel="preload" href="performance-optimizations.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="performance-optimizations.css"></noscript>
    
    <link rel="preload" href="mobile-responsiveness-fixes.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="mobile-responsiveness-fixes.css"></noscript>
    
    <!-- Font Awesome - Load asynchronously -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"></noscript>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    
    <!-- Google Sign-In SDK -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <meta name="google-signin-client_id" content="210907983255-shldg58sre4vf2o4gk97nfgqj91p1s73.apps.googleusercontent.com">
    
    <!-- Google Sign-In will be handled by auth.js -->
    <style>
        .auth-container {
            min-height: calc(100vh - 80px);
            padding-top: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--background-color);
            padding: 100px 20px 20px 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .auth-box {
            background: var(--card-background);
            border-radius: 25px;
            box-shadow: 0 25px 80px rgba(22, 105, 122, 0.15);
            overflow: hidden;
            width: 100%;
            max-width: 450px;
            position: relative;
            border: 1px solid rgba(22, 105, 122, 0.1);
        }

        .brand-section {
            text-align: center;
            padding: 40px 30px 20px 30px;
            background: var(--card-background);
        }

        .brand-logo {
            width: 80px;
            height: 80px;
            background: var(--primary-color);
            border-radius: 20px;
            margin: 0 auto 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 25px rgba(22, 105, 122, 0.3);
        }

        .brand-logo i {
            font-size: 36px;
            color: white;
        }

        .brand-title {
            font-size: 28px;
            font-weight: 700;
            color: var(--text-color);
            margin-bottom: 8px;
            letter-spacing: 2px;
        }

        .brand-subtitle {
            font-size: 16px;
            color: var(--accent-color);
            font-weight: 500;
            margin-bottom: 0;
        }

        .auth-tabs {
            display: flex;
            background: var(--secondary-color);
            margin: 0 30px;
            border-radius: 15px;
            padding: 5px;
            margin-bottom: 30px;
        }

        .auth-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border: none;
            background: none;
            font-weight: 600;
            color: var(--text-color);
            transition: all 0.3s ease;
            position: relative;
            font-size: 16px;
            border-radius: 12px;
        }

        .auth-tab.active {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 4px 15px rgba(22, 105, 122, 0.3);
            transform: translateY(-2px);
        }

        .auth-tab:hover:not(.active) {
            background: rgba(22, 105, 122, 0.1);
            color: var(--primary-color);
        }

        .auth-content {
            padding: 0 40px 40px 40px;
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text-color);
            font-size: 15px;
        }

        .form-input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--secondary-color);
            border-radius: 15px;
            font-size: 16px;
            transition: all 0.3s ease;
            box-sizing: border-box;
            background: var(--card-background);
            color: var(--text-color);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(22, 105, 122, 0.1);
            background: var(--card-background);
        }

        .form-input:hover {
            border-color: var(--accent-color);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(22, 105, 122, 0.1);
        }

        .form-input.error {
            border-color: #dc3545;
        }

        .form-error {
            color: #dc3545;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }

        .form-error.show {
            display: block;
        }

        .auth-button {
            width: 100%;
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 18px;
            border-radius: 15px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            box-shadow: 0 6px 20px rgba(22, 105, 122, 0.3);
        }

        .auth-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.2);
            transition: left 0.5s;
        }

        .auth-button:hover::before {
            left: 100%;
        }

        .auth-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(22, 105, 122, 0.4);
            background: var(--accent-color);
        }

        .auth-button:active {
            transform: translateY(-1px);
        }

        .auth-button:disabled {
            background: #E0E0E0;
            color: #999;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .divider {
            text-align: center;
            margin: 30px 0;
            position: relative;
            color: #B8B8B8;
            font-size: 14px;
        }

        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: var(--secondary-color);
            z-index: 1;
        }

        .divider span {
            background: white;
            padding: 0 20px;
            position: relative;
            z-index: 2;
        }

        .social-login {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .social-btn {
            flex: 1;
            padding: 14px;
            border: 2px solid var(--secondary-color);
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .social-btn:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(22, 105, 122, 0.2);
        }

        .google-btn {
            color: #DB4437;
        }

        .facebook-btn {
            color: #4267B2;
        }

        .back-to-site {
            text-align: center;
            margin-top: 30px;
        }

        .back-to-site a {
            color: var(--accent-color);
            text-decoration: none;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .back-to-site a:hover {
            color: var(--highlight-color);
            transform: translateX(-3px);
        }

        .password-toggle {
            position: relative;
        }

        .password-toggle-btn {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            padding: 5px;
        }

        .forgot-password {
            text-align: center;
            margin: 15px 0;
        }

        .forgot-password a {
            color: var(--accent-color);
            text-decoration: none;
            font-size: 14px;
        }

        .forgot-password a:hover {
            text-decoration: underline;
            color: var(--primary-color);
        }

        .social-auth {
            margin: 20px 0;
            text-align: center;
        }

        .social-divider {
            position: relative;
            margin: 20px 0;
            text-align: center;
            color: #666;
        }

        .social-divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: var(--secondary-color);
        }

        .social-divider span {
            background: white;
            padding: 0 15px;
            color: var(--text-color);
        }

        .social-button {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: 2px solid var(--secondary-color);
            border-radius: 12px;
            background: white;
            color: var(--text-color);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .social-button:hover {
            border-color: var(--primary-color);
            background: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(22, 105, 122, 0.15);
        }

        .google-btn {
            color: #db4437;
        }

        .facebook-btn {
            color: #4267B2;
        }

        .back-home {
            text-align: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--secondary-color);
        }

        .back-home a {
            color: var(--accent-color);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .back-home a:hover {
            text-decoration: underline;
            color: var(--primary-color);
        }

        .success-message {
            background: var(--success-color);
            color: white;
            padding: 12px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: none;
            font-weight: 600;
        }

        .success-message.show {
            display: block;
        }

        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .loading-overlay.show {
            display: flex;
        }

        .loading-spinner {
            font-size: 24px;
            color: var(--primary-color);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .password-toggle-btn {
            color: var(--accent-color);
            transition: color 0.3s ease;
        }

        .password-toggle-btn:hover {
            color: var(--primary-color);
        }

        /* Mobile OTP Authentication Styles */
        .phone-input-container {
            display: flex;
            border: 2px solid var(--secondary-color);
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .phone-input-container:focus-within {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(22, 105, 122, 0.1);
        }

        .country-code {
            background: var(--secondary-color);
            padding: 16px 15px;
            display: flex;
            align-items: center;
            font-weight: 600;
            color: var(--text-color);
            border-right: 1px solid var(--secondary-color);
        }

        .phone-input {
            border: none !important;
            border-radius: 0 !important;
            box-shadow: none !important;
            flex: 1;
            margin: 0;
        }

        .phone-input:focus {
            outline: none;
            border: none !important;
            box-shadow: none !important;
        }

        .terms-section {
            margin: 20px 0;
        }

        .checkbox-container {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            cursor: pointer;
            line-height: 1.4;
        }

        .checkbox-container input[type="checkbox"] {
            display: none;
        }

        .checkmark {
            width: 20px;
            height: 20px;
            border: 2px solid var(--secondary-color);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .checkbox-container input[type="checkbox"]:checked + .checkmark {
            background: var(--primary-color);
            border-color: var(--primary-color);
        }

        .checkbox-container input[type="checkbox"]:checked + .checkmark::after {
            content: 'âœ“';
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .terms-text {
            font-size: 14px;
            color: var(--text-color);
        }

        .terms-link {
            color: var(--accent-color);
            text-decoration: none;
            font-weight: 600;
        }

        .terms-link:hover {
            color: var(--primary-color);
            text-decoration: underline;
        }

        .help-text {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
            color: #666;
        }

        .help-link {
            color: var(--accent-color);
            text-decoration: none;
            font-weight: 600;
        }

        .help-link:hover {
            color: var(--primary-color);
            text-decoration: underline;
        }

        /* OTP Step Styles */
        .otp-step {
            animation: slideInRight 0.3s ease;
        }

        .otp-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .back-btn {
            background: none;
            border: none;
            color: var(--accent-color);
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .back-btn:hover {
            background: var(--secondary-color);
            color: var(--primary-color);
        }

        .otp-header h3 {
            margin: 0;
            font-size: 20px;
            color: var(--text-color);
        }

        .otp-message {
            text-align: center;
            margin-bottom: 30px;
            color: var(--text-color);
            line-height: 1.5;
        }

        .otp-input-container {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .otp-input, .signup-otp-input {
            width: 45px;
            height: 45px;
            border: 2px solid var(--secondary-color);
            border-radius: 8px;
            text-align: center;
            font-size: 18px;
            font-weight: 600;
            color: var(--text-color);
            transition: all 0.3s ease;
        }

        .otp-input:focus, .signup-otp-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(22, 105, 122, 0.1);
        }

        .otp-input.filled, .signup-otp-input.filled {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .resend-section {
            text-align: center;
            margin: 20px 0;
        }

        .timer-text {
            font-size: 14px;
            color: #666;
            margin-right: 15px;
        }

        .resend-btn {
            background: none;
            border: none;
            color: var(--accent-color);
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: color 0.3s ease;
        }

        .resend-btn:hover:not(:disabled) {
            color: var(--primary-color);
        }

        .resend-btn:disabled {
            color: #ccc;
            cursor: not-allowed;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideInLeft {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .phone-step.slide-out {
            animation: slideOutLeft 0.3s ease forwards;
        }

        @keyframes slideOutLeft {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(-100%);
                opacity: 0;
            }
        }

        /* Enhanced responsive styles */
        @media (max-width: 480px) {
            .auth-container {
                padding: 10px;
            }

            .auth-content {
                padding: 0 20px 30px 20px;
            }

            .auth-box {
                margin: 10px;
                max-width: 100%;
            }

            .brand-section {
                padding: 30px 20px 15px 20px;
            }

            .brand-title {
                font-size: 24px;
                letter-spacing: 1px;
            }

            .brand-logo {
                width: 60px;
                height: 60px;
            }

            .brand-logo i {
                font-size: 28px;
            }

            .auth-tabs {
                margin: 0 20px 20px 20px;
                padding: 3px;
            }

            .auth-tab {
                font-size: 14px;
                padding: 12px 8px;
            }

            .form-input {
                padding: 14px 18px;
                font-size: 16px;
            }

            .auth-button {
                padding: 16px;
                font-size: 16px;
            }

            .otp-input-container {
                gap: 8px;
            }

            .otp-input, .signup-otp-input {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }

            .terms-text {
                font-size: 13px;
            }

            .country-code {
                padding: 14px 12px;
                font-size: 14px;
            }
        }

        /* Profile Dropdown Styles */
        .profile-dropdown {
            position: relative;
        }

        .profile-dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: rgba(237, 231, 227, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(22, 105, 122, 0.2);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            padding: 8px;
            min-width: 180px;
            z-index: 1001;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .profile-dropdown-menu.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
            pointer-events: auto;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 12px;
            color: var(--text-color);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .dropdown-item:hover {
            background: rgba(22, 105, 122, 0.1);
            color: var(--primary-color);
            text-decoration: none;
        }

        .dropdown-divider {
            height: 1px;
            background: rgba(22, 105, 122, 0.2);
            margin: 8px 0;
        }

        .cart-icon-btn {
            background: transparent;
            backdrop-filter: none;
            -webkit-backdrop-filter: none;
            border: none;
            border-radius: 8px;
            color: #16697A;
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            box-shadow: none;
            font-weight: 600;
            min-width: 50px;
            text-align: center;
            font-size: 20px;
        }

        .cart-icon-btn:hover {
            background: rgba(22, 105, 122, 0.25);
            border: 1px solid rgba(22, 105, 122, 0.4);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            color: white;
        }

        .cart-icon-btn i {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            margin: 0;
            line-height: 1;
            font-size: 16px;
        }

        .cart-count {
            background: var(--highlight-color);
            color: white;
            border-radius: 12px;
            padding: 3px 7px;
            font-size: 11px;
            font-weight: 700;
            min-width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            top: -5px;
            right: 5px;
            z-index: 10;
        }

        .cart-count:empty {
            display: none;
        }

        .button-label {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            line-height: 1;
            margin: 0;
            width: 100%;
            text-align: center;
            color: inherit;
        }

        /* Header and Dropdown Styles - Matching Homepage */
        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .auth-section {
            display: flex;
            align-items: center;
        }

        .profile-dropdown {
            position: relative;
        }

        /* header button styles are in style.css */

        .profile-icon-btn:hover {
            background: rgba(22, 105, 122, 0.25);
            border: 1px solid rgba(22, 105, 122, 0.4);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            color: white;
        }
        /* header mobile tweaks use style.css defaults */

        .profile-icon-btn .button-label {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            line-height: 1;
            margin: 0;
            width: 100%;
            text-align: center;
        }

        .profile-dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            min-width: 220px;
            z-index: 3000;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            margin-top: 10px;
            padding: 8px 0;
        }

        .profile-dropdown:hover .profile-dropdown-menu,
        .profile-dropdown.open .profile-dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .profile-dropdown-menu .dropdown-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            color: #333;
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
            border-radius: 8px;
            margin: 2px 8px;
        }

        .profile-dropdown-menu .dropdown-item:hover {
            background: linear-gradient(135deg, rgba(72, 159, 181, 0.1), rgba(72, 159, 181, 0.05));
            color: #489FB5;
            transform: translateX(5px);
        }

        .profile-dropdown-menu .dropdown-divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(72, 159, 181, 0.3), transparent);
            margin: 8px 16px;
        }

        /* User Info Section in Dropdown */
        .dropdown-user-info {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background: rgba(22, 105, 122, 0.05);
            border-radius: 8px;
            margin: 8px;
        }

        .dropdown-user-info .user-avatar {
            font-size: 24px;
            color: #16697A;
            margin-right: 12px;
        }

        .dropdown-user-info .user-details {
            flex: 1;
        }

        .dropdown-user-info .user-name {
            font-weight: 600;
            color: #16697A;
            font-size: 14px;
            margin-bottom: 2px;
        }

        .dropdown-user-info .user-phone {
            color: #489FB5;
            font-size: 12px;
        }

        /* Mobile Responsive Styles */
        @media (max-width: 768px) {
            .site-header {
                position: relative !important;
                top: auto;
                margin-bottom: 0;
                background: var(--background-color);
                padding: 10px 0;
                box-shadow: none;
                border-radius: 0;
                z-index: 2500;
            }

            .header-content {
                background: transparent;
                border-radius: 0;
                padding: 0 1rem;
                border: none;
                box-shadow: none;
                gap: 0.75rem;
            }

            .header-right {
                gap: 10px;
            }

            .profile-icon-btn,
            .cart-icon-btn {
                background: transparent;
                border: none;
                border-radius: 0;
                padding: 6px;
                box-shadow: none;
                color: #16697A;
            }

            .profile-icon-btn {
                font-size: 20px;
                min-width: 40px;
                gap: 2px;
            }

            .profile-icon-btn i {
                font-size: 16px;
            }

            .profile-icon-btn:hover,
            .cart-icon-btn:hover {
                background: transparent;
                color: #0f4f5d;
                border: none;
                box-shadow: none;
            }

            .profile-icon-btn .button-label,
            .cart-icon-btn .button-label {
                font-size: 0.62rem;
                letter-spacing: 0.4px;
            }

            body {
                padding-top: 0;
            }
        }

        @media (max-width: 480px) {
            .site-header {
                padding: 10px 0;
            }

            .header-content {
                padding: 0 0.85rem;
                gap: 0.55rem;
            }

            .brand-name {
                font-size: 1.65rem;
                letter-spacing: 1px;
            }

            .profile-icon-btn,
            .cart-icon-btn {
                padding: 6px 9px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="site-header">
        <div class="header-content">
            <div class="header-left"></div>
            <div class="header-brand">
                <h1 class="brand-name">JB Creations</h1>
            </div>
            <div class="header-right">
                <div class="auth-section" id="authSection">
                    <!-- Profile dropdown button (always visible) -->
                    <div class="profile-dropdown" id="profileDropdown">
                        <button class="profile-icon-btn" id="profileBtn">
                            <i class="fas fa-user-alt"></i>
                            <span class="button-label">Profile</span>
                        </button>
                        <div class="profile-dropdown-menu" id="profileDropdownMenu">
                            <!-- Guest user options -->
                            <div class="guest-options" id="guestOptions">
                                <a href="otp-login.html?redirect=auth.html" class="dropdown-item">
                                    <i class="fas fa-sign-in-alt"></i>
                                    Sign In
                                </a>
                                <a href="otp-login.html?redirect=auth.html" class="dropdown-item">
                                    <i class="fas fa-user-plus"></i>
                                    Sign Up
                                </a>
                                <div class="dropdown-divider"></div>
                            </div>
                            
                            <!-- Authenticated user options (hidden by default) -->
                            <div class="authenticated-options" id="authenticatedOptions" style="display: none;">
                                <!-- User Info Section -->
                                <div class="dropdown-user-info" id="dropdownUserInfo">
                                    <div class="user-avatar">
                                        <i class="fas fa-user-circle"></i>
                                    </div>
                                    <div class="user-details">
                                        <div class="user-name" id="dropdownUserName">User</div>
                                        <div class="user-phone" id="dropdownUserPhone">Phone</div>
                                    </div>
                                </div>
                                <div class="dropdown-divider"></div>
                                
                                <a href="my-profile.html" class="dropdown-item" data-close-dropdown="true">
                                    <i class="fas fa-user-circle"></i>
                                    My Profile
                                </a>
                                <a href="#" class="dropdown-item" onclick="viewOrders()">
                                    <i class="fas fa-box"></i>
                                    My Orders
                                </a>
                                <div class="dropdown-divider"></div>
                                <a href="#" class="dropdown-item" onclick="authUtils.logout()">
                                    <i class="fas fa-sign-out-alt"></i>
                                    Sign Out
                                </a>
                                <div class="dropdown-divider"></div>
                            </div>
                            
                            <!-- Common options for all users -->
                            <a href="track-order.html" class="dropdown-item">
                                <i class="fas fa-search"></i>
                                Track Order
                            </a>
                            <a href="#" class="dropdown-item" onclick="contactUs()">
                                <i class="fas fa-envelope"></i>
                                Contact Us
                            </a>
                            <a href="#" class="dropdown-item" onclick="aboutUs()">
                                <i class="fas fa-info-circle"></i>
                                About Us
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="header-cart">
                    <button class="cart-icon-btn" id="headerCartBtn" onclick="window.location.href='cart.html'">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-count" id="cartCount">0</span>
                        <span class="button-label">Cart</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="auth-container">
        <div class="auth-box">
            <div class="loading-overlay" id="loadingOverlay">
                <div class="loading-spinner">
                    <i class="fas fa-spinner"></i>
                </div>
            </div>

            <!-- Brand Section -->
            <div class="brand-section">
                <div class="brand-logo">
                    <i class="fas fa-image"></i>
                </div>
                <h1 class="brand-title">JB CREATIONS</h1>
                <p class="brand-subtitle">Beautiful Memories Deserve a Frame</p>
            </div>

            <!-- Tab Navigation -->
            <div class="auth-tabs">
                <button class="auth-tab active" onclick="switchTab('signin')">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
                <button class="auth-tab" onclick="switchTab('signup')">
                    <i class="fas fa-user-plus"></i> Signup
                </button>
            </div>

            <div class="auth-content">
                <div class="success-message" id="successMessage"></div>

                <!-- Mobile Login Form -->
                <div class="auth-form active" id="signinForm">
                    <!-- Phone Number Step -->
                    <div class="phone-step" id="phoneStep">
                        <form id="phoneForm" onsubmit="sendOtp(event)">
                            <div class="form-group">
                                <label for="loginPhone">Mobile Number</label>
                                <div class="phone-input-container">
                                    <div class="country-code">
                                        <span>+91</span>
                                    </div>
                                    <input type="tel" id="loginPhone" name="phone" class="form-input phone-input" 
                                           placeholder="8269909774" pattern="[0-9]{10}" maxlength="10" required>
                                </div>
                                <div class="form-error" id="loginPhoneError"></div>
                            </div>

                            <div class="terms-section">
                                <label class="checkbox-container">
                                    <input type="checkbox" id="termsCheckbox" required>
                                    <span class="checkmark"></span>
                                    <span class="terms-text">
                                        By continuing, I agree to the 
                                        <a href="#" class="terms-link">Terms of Use</a> & 
                                        <a href="#" class="terms-link">Privacy Policy</a> 
                                        and I am above 18 years old.
                                    </span>
                                </label>
                            </div>

                            <button type="submit" class="auth-button" id="sendOtpButton">
                                CONTINUE
                            </button>
                        </form>

                        <div class="help-text">
                            Have trouble logging in? <a href="#" class="help-link">Get help</a>
                        </div>
                    </div>

                    <!-- OTP Verification Step -->
                    <div class="otp-step" id="otpStep" style="display: none;">
                        <div class="otp-header">
                            <button class="back-btn" onclick="goBackToPhone()">
                                <i class="fas fa-arrow-left"></i>
                            </button>
                            <h3>Enter OTP</h3>
                        </div>
                        
                        <p class="otp-message">
                            We've sent a 6-digit code to <strong id="phoneDisplay"></strong>
                        </p>

                        <form id="otpForm" onsubmit="verifyOtp(event)">
                            <div class="form-group">
                                <div class="otp-input-container">
                                    <input type="text" class="otp-input" maxlength="1" pattern="[0-9]">
                                    <input type="text" class="otp-input" maxlength="1" pattern="[0-9]">
                                    <input type="text" class="otp-input" maxlength="1" pattern="[0-9]">
                                    <input type="text" class="otp-input" maxlength="1" pattern="[0-9]">
                                    <input type="text" class="otp-input" maxlength="1" pattern="[0-9]">
                                    <input type="text" class="otp-input" maxlength="1" pattern="[0-9]">
                                </div>
                                <div class="form-error" id="otpError"></div>
                            </div>

                            <div class="resend-section">
                                <span class="timer-text">Resend OTP in <span id="timer">30</span>s</span>
                                <button type="button" class="resend-btn" id="resendBtn" onclick="resendOtp()" disabled>
                                    Resend OTP
                                </button>
                            </div>

                            <button type="submit" class="auth-button" id="verifyOtpButton">
                                VERIFY OTP
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Mobile Signup Form -->
                <div class="auth-form" id="signupForm">
                    <!-- Phone Number Step for Signup -->
                    <div class="phone-step" id="signupPhoneStep">
                        <form id="signupPhoneForm" onsubmit="sendSignupOtp(event)">
                            <div class="form-group">
                                <label for="signupName">Full Name</label>
                                <input type="text" id="signupName" name="name" class="form-input" 
                                       placeholder="Enter your full name" required>
                                <div class="form-error" id="signupNameError"></div>
                            </div>

                            <div class="form-group">
                                <label for="signupPhone">Mobile Number</label>
                                <div class="phone-input-container">
                                    <div class="country-code">
                                        <span>+91</span>
                                    </div>
                                    <input type="tel" id="signupPhone" name="phone" class="form-input phone-input" 
                                           placeholder="8269909774" pattern="[0-9]{10}" maxlength="10" required>
                                </div>
                                <div class="form-error" id="signupPhoneError"></div>
                            </div>

                            <div class="form-group">
                                <label for="signupEmail">Email Address (Optional)</label>
                                <input type="email" id="signupEmail" name="email" class="form-input" 
                                       placeholder="Enter your email">
                                <div class="form-error" id="signupEmailError"></div>
                            </div>

                            <div class="terms-section">
                                <label class="checkbox-container">
                                    <input type="checkbox" id="signupTermsCheckbox" required>
                                    <span class="checkmark"></span>
                                    <span class="terms-text">
                                        By continuing, I agree to the 
                                        <a href="#" class="terms-link">Terms of Use</a> & 
                                        <a href="#" class="terms-link">Privacy Policy</a> 
                                        and I am above 18 years old.
                                    </span>
                                </label>
                            </div>

                            <button type="submit" class="auth-button" id="sendSignupOtpButton">
                                CONTINUE
                            </button>
                        </form>
                    </div>

                    <!-- OTP Verification Step for Signup -->
                    <div class="otp-step" id="signupOtpStep" style="display: none;">
                        <div class="otp-header">
                            <button class="back-btn" onclick="goBackToSignupPhone()">
                                <i class="fas fa-arrow-left"></i>
                            </button>
                            <h3>Enter OTP</h3>
                        </div>
                        
                        <p class="otp-message">
                            We've sent a 6-digit code to <strong id="signupPhoneDisplay"></strong>
                        </p>

                        <form id="signupOtpForm" onsubmit="verifySignupOtp(event)">
                            <div class="form-group">
                                <div class="otp-input-container">
                                    <input type="text" class="signup-otp-input" maxlength="1" pattern="[0-9]">
                                    <input type="text" class="signup-otp-input" maxlength="1" pattern="[0-9]">
                                    <input type="text" class="signup-otp-input" maxlength="1" pattern="[0-9]">
                                    <input type="text" class="signup-otp-input" maxlength="1" pattern="[0-9]">
                                    <input type="text" class="signup-otp-input" maxlength="1" pattern="[0-9]">
                                    <input type="text" class="signup-otp-input" maxlength="1" pattern="[0-9]">
                                </div>
                                <div class="form-error" id="signupOtpError"></div>
                            </div>

                            <div class="resend-section">
                                <span class="timer-text">Resend OTP in <span id="signupTimer">30</span>s</span>
                                <button type="button" class="resend-btn" id="signupResendBtn" onclick="resendSignupOtp()" disabled>
                                    Resend OTP
                                </button>
                            </div>

                            <button type="submit" class="auth-button" id="verifySignupOtpButton">
                                CREATE ACCOUNT
                            </button>
                        </form>
                    </div>
                </div>

                <div class="back-to-site">
                    <a href="index.html">
                        <i class="fas fa-arrow-left"></i>
                        Back to Website
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script src="auth.js"></script>
    <script>
        function setProfileDropdownState(isOpen) {
            const dropdownContainer = document.getElementById('profileDropdown');
            const dropdownMenu = document.getElementById('profileDropdownMenu');
            const profileBtn = document.getElementById('profileBtn');

            if (!dropdownContainer || !dropdownMenu || !profileBtn) {
                return;
            }

            dropdownContainer.classList.toggle('open', isOpen);
            profileBtn.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
            dropdownMenu.setAttribute('aria-hidden', isOpen ? 'false' : 'true');
        }

        function toggleProfileDropdown() {
            const dropdownContainer = document.getElementById('profileDropdown');
            if (!dropdownContainer) {
                return;
            }

            const isOpen = dropdownContainer.classList.contains('open');
            setProfileDropdownState(!isOpen);
        }

        function setupProfileDropdown() {
            const dropdownContainer = document.getElementById('profileDropdown');
            const dropdownMenu = document.getElementById('profileDropdownMenu');
            const profileBtn = document.getElementById('profileBtn');

            if (!dropdownContainer || !dropdownMenu || !profileBtn || dropdownContainer.dataset.dropdownInit === 'true') {
                return;
            }

            dropdownContainer.dataset.dropdownInit = 'true';

            profileBtn.setAttribute('aria-haspopup', 'true');
            profileBtn.setAttribute('aria-expanded', 'false');
            dropdownMenu.setAttribute('role', 'menu');
            dropdownMenu.setAttribute('aria-hidden', 'true');

            profileBtn.addEventListener('click', function(event) {
                event.preventDefault();
                event.stopPropagation();
                toggleProfileDropdown();
            });

            dropdownMenu.addEventListener('click', function(event) {
                const actionableItem = event.target.closest('a, button');
                if (actionableItem && actionableItem.dataset.closeDropdown === 'true') {
                    setProfileDropdownState(false);
                }
            });

            setProfileDropdownState(false);
        }

        // Header functionality
        document.addEventListener('DOMContentLoaded', async function() {
            setupProfileDropdown();

            // Cart functionality - redirect to cart page
            const headerCartBtn = document.getElementById('headerCartBtn');
            if (headerCartBtn) {
                headerCartBtn.addEventListener('click', function() {
                    window.location.href = 'cart.html';
                });
            }

            // Update cart count from localStorage
            updateCartCount();
            
            // Update authentication UI
            await updateAuthUI();
        });

        // Get current authenticated user from Firebase
        async function getCurrentAuthenticatedUser() {
            try {
                // Wait for Firebase to be ready with retry mechanism
                const maxRetries = 5; // Reduced from 10 since we now have the proper scripts
                for (let i = 0; i < maxRetries; i++) {
                    if (typeof window.otpAuth !== 'undefined') {
                        console.log('ðŸ“± Getting current user from Firebase...');
                        const user = await window.otpAuth.getCurrentUser();
                        console.log('ðŸ“± Firebase user result:', user);
                        return user;
                    } else {
                        console.log(`â³ Firebase not ready yet, retrying... (${i + 1}/${maxRetries})`);
                        await new Promise(resolve => setTimeout(resolve, 300)); // Reduced from 500ms
                    }
                }
                
                console.log('âŒ OTP Auth system not available after retries, falling back to localStorage');
                // Fallback to localStorage if Firebase is not available after retries
                const userDataStr = localStorage.getItem('jb_current_user');
                if (!userDataStr) return null;
                
                try {
                    return JSON.parse(userDataStr);
                } catch (parseError) {
                    console.log('Failed to parse user data as JSON, might be old format:', userDataStr);
                    if (userDataStr.startsWith('+91') || userDataStr.startsWith('+')) {
                        return { phone: userDataStr, name: 'User' };
                    }
                    return null;
                }
            } catch (error) {
                console.error('âŒ Error getting current user from Firebase:', error);
                return null;
            }
        }

        // Update authentication UI based on login status
        async function updateAuthUI() {
            try {
                const user = await getCurrentAuthenticatedUser();
                console.log('ðŸ“± updateAuthUI - user found:', user);
                
                const guestOptions = document.getElementById('guestOptions');
                const authenticatedOptions = document.getElementById('authenticatedOptions');
                const profileBtn = document.getElementById('profileBtn');
                
                if (user) {
                    console.log('ðŸ“± updateAuthUI - user name:', user.name);
                    console.log('ðŸ“± updateAuthUI - user phone:', user.phone);
                    
                    // User is logged in - show authenticated options, hide guest options
                    if (guestOptions) {
                        guestOptions.style.display = 'none';
                    }
                    if (authenticatedOptions) {
                        authenticatedOptions.style.display = 'block';
                    }
                    
                    // Update user info in dropdown
                    const dropdownUserName = document.getElementById('dropdownUserName');
                    const dropdownUserPhone = document.getElementById('dropdownUserPhone');
                    
                    if (dropdownUserName) {
                        dropdownUserName.textContent = user.name || 'User';
                        console.log('ðŸ“± updateAuthUI - Set dropdown name to:', user.name || 'User');
                    }
                    if (dropdownUserPhone) {
                        dropdownUserPhone.textContent = user.phone || 'Phone not available';
                    }
                    
                    // Always keep profile button text as "Profile"
                    if (profileBtn) {
                        profileBtn.innerHTML = `
                            <i class="fas fa-user-alt"></i>
                            <span class="button-label">Profile</span>
                        `;
                        profileBtn.style.color = '#16697A';
                    }
                } else {
                    // User is not logged in - show guest options, hide authenticated options
                    if (guestOptions) {
                        guestOptions.style.display = 'block';
                    }
                    if (authenticatedOptions) {
                        authenticatedOptions.style.display = 'none';
                    }
                    
                    // Reset profile button to default
                    if (profileBtn) {
                        profileBtn.innerHTML = `
                            <i class="fas fa-user-alt"></i>
                            <span class="button-label">Profile</span>
                        `;
                    }
                }
            } catch (error) {
                console.error('âŒ Error updating auth UI:', error);
            }
        }

        // View user profile / toggle dropdown
        function viewProfile() {
            window.location.href = 'my-profile.html';
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdownContainer = document.getElementById('profileDropdown');
            if (!dropdownContainer) {
                return;
            }

            if (!dropdownContainer.contains(event.target)) {
                setProfileDropdownState(false);
            }
        });

        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                setProfileDropdownState(false);
            }
        });

        // View user orders
        function viewOrders() {
            window.location.href = 'my-orders.html';
        }

        // Contact us function
        function contactUs() {
            alert('Contact Us\n\nEmail: contact@jbcreations.com\nPhone: +91 12345 67890\nAddress: 123 Art Street, Creative City, India\n\nWe\'d love to hear from you!');
        }

        // About us function
        function aboutUs() {
            alert('About JB Creations\n\nWe are passionate about turning your precious memories into beautiful wall art. With years of experience in custom photo framing, we use premium materials and professional craftsmanship to create frames that last a lifetime.\n\nOur mission is to help you showcase your most cherished moments in style.');
        }

        // Update cart count in header
        function updateCartCount() {
            const cartCount = document.getElementById('cartCount');
            if (cartCount) {
                const cart = JSON.parse(localStorage.getItem('photoFramingCart') || '[]');
                cartCount.textContent = cart.length;
            }
        }
    </script>

    <!-- Auth API Client for Server Communication -->
    <script src="auth-api.js?v=3.0"></script>
    
    <!-- Fast2SMS OTP Client for Real OTP Integration -->
    <script src="fast2sms-client.js?v=3.0"></script>
    
    <!-- Firebase Configuration (keeping as backup) -->
    <script type="module" src="firebase-config.js?v=3.0"></script>
    
    <!-- OTP Auth with Fast2SMS Integration -->
    <script src="otp-auth-realsms.js?v=3.0"></script>
    
    <!-- Performance optimization scripts -->
    <script src="performance-optimizations.js?v=3.0" defer></script>
    <script src="third-party-optimizations.js?v=3.0" defer></script>
    <script src="caching-optimization.js?v=3.0" defer></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('SW registered: ', registration);
                    })
                    .catch(function(registrationError) {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
    
    <!-- reCAPTCHA Container (required for Firebase phone auth) -->
    <div id="recaptcha-container" style="display: none;"></div>
</body>
</html>
