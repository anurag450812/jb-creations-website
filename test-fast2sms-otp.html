<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fast2SMS OTP Test - JB Creations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #16697A;
            --secondary-color: #EDE7E3;
            --accent-color: #489FB5;
            --success-color: #82C0CC;
            --error-color: #ff4444;
            --warning-color: #FFA62B;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--secondary-color) 0%, #ffffff 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 14px;
        }

        .test-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .test-section h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary-color);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--primary-color);
            font-weight: 600;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--secondary-color);
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--accent-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(22, 105, 122, 0.3);
        }

        .btn-secondary {
            background: var(--warning-color);
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #e69520;
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .result-box {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }

        .result-box.success {
            background: #e8f5e9;
            border: 2px solid var(--success-color);
            color: #2e7d32;
        }

        .result-box.error {
            background: #ffebee;
            border: 2px solid var(--error-color);
            color: #c62828;
        }

        .result-box.info {
            background: #e3f2fd;
            border: 2px solid var(--accent-color);
            color: #1565c0;
        }

        .result-box h4 {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .result-box pre {
            background: rgba(0, 0, 0, 0.05);
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }

        .config-status {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .config-status.configured {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .config-status.not-configured {
            background: #fff3e0;
            color: #e65100;
        }

        .timer {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            color: var(--warning-color);
            font-weight: 600;
        }

        .instructions {
            background: #fff9e6;
            border-left: 4px solid var(--warning-color);
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .instructions h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .instructions ol {
            margin-left: 20px;
        }

        .instructions li {
            margin-bottom: 8px;
            color: #666;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-mobile-alt"></i> Fast2SMS OTP Integration Test</h1>
            <p>Test your Fast2SMS DLT OTP integration for JB Creations</p>
        </div>

        <!-- Configuration Instructions -->
        <div class="test-section">
            <h2><i class="fas fa-cog"></i> Configuration Setup</h2>
            <div class="instructions">
                <h3>Setup Steps:</h3>
                <ol>
                    <li>Open <code>fast2sms-config.js</code> and add your Fast2SMS API Key</li>
                    <li>Add your DLT Template ID registered on Jio True Connect</li>
                    <li>Update the Sender ID with your registered sender ID</li>
                    <li>Install required dependencies: <code>npm install axios</code> in order-backend folder</li>
                    <li>Start the auth server: <code>node order-backend/auth-server.js</code></li>
                </ol>
            </div>
            <div id="configStatus" class="config-status not-configured">
                <i class="fas fa-exclamation-triangle"></i>
                <span>Fast2SMS configuration pending. Please update fast2sms-config.js</span>
            </div>
        </div>

        <!-- Test Sections Grid -->
        <div class="grid">
            <!-- Send OTP Test -->
            <div class="test-section">
                <h2><i class="fas fa-paper-plane"></i> 1. Send OTP</h2>
                <div class="form-group">
                    <label for="sendPhone">Phone Number (10 digits)</label>
                    <input type="tel" id="sendPhone" placeholder="9876543210" maxlength="10" />
                </div>
                <div class="form-group">
                    <label for="otpType">Type</label>
                    <select id="otpType" style="width: 100%; padding: 12px; border: 2px solid var(--secondary-color); border-radius: 8px;">
                        <option value="login">Login</option>
                        <option value="register">Register</option>
                    </select>
                </div>
                <button class="btn btn-primary" onclick="testSendOTP()">
                    <i class="fas fa-paper-plane"></i> Send OTP
                </button>
                <div id="sendResult" class="result-box"></div>
            </div>

            <!-- Verify OTP Test -->
            <div class="test-section">
                <h2><i class="fas fa-check-circle"></i> 2. Verify OTP</h2>
                <div class="form-group">
                    <label for="verifyPhone">Phone Number</label>
                    <input type="tel" id="verifyPhone" placeholder="9876543210" maxlength="10" />
                </div>
                <div class="form-group">
                    <label for="otpCode">OTP Code (6 digits)</label>
                    <input type="text" id="otpCode" placeholder="123456" maxlength="6" />
                </div>
                <button class="btn btn-primary" onclick="testVerifyOTP()">
                    <i class="fas fa-check"></i> Verify OTP
                </button>
                <div id="verifyResult" class="result-box"></div>
            </div>

            <!-- Resend OTP Test -->
            <div class="test-section">
                <h2><i class="fas fa-redo"></i> 3. Resend OTP</h2>
                <div class="form-group">
                    <label for="resendPhone">Phone Number</label>
                    <input type="tel" id="resendPhone" placeholder="9876543210" maxlength="10" />
                </div>
                <button class="btn btn-secondary" onclick="testResendOTP()">
                    <i class="fas fa-redo"></i> Resend OTP
                </button>
                <div id="resendResult" class="result-box"></div>
            </div>

            <!-- Register Test -->
            <div class="test-section">
                <h2><i class="fas fa-user-plus"></i> 4. Register User</h2>
                <div class="form-group">
                    <label for="regName">Full Name</label>
                    <input type="text" id="regName" placeholder="John Doe" />
                </div>
                <div class="form-group">
                    <label for="regPhone">Phone Number</label>
                    <input type="tel" id="regPhone" placeholder="9876543210" maxlength="10" />
                </div>
                <div class="form-group">
                    <label for="regEmail">Email (optional)</label>
                    <input type="email" id="regEmail" placeholder="john@example.com" />
                </div>
                <div class="form-group">
                    <label for="regOTP">OTP Code</label>
                    <input type="text" id="regOTP" placeholder="123456" maxlength="6" />
                </div>
                <button class="btn btn-success" onclick="testRegister()">
                    <i class="fas fa-user-plus"></i> Register
                </button>
                <div id="regResult" class="result-box"></div>
            </div>

            <!-- Login Test -->
            <div class="test-section">
                <h2><i class="fas fa-sign-in-alt"></i> 5. Login User</h2>
                <div class="form-group">
                    <label for="loginPhone">Phone Number</label>
                    <input type="tel" id="loginPhone" placeholder="9876543210" maxlength="10" />
                </div>
                <div class="form-group">
                    <label for="loginOTP">OTP Code</label>
                    <input type="text" id="loginOTP" placeholder="123456" maxlength="6" />
                </div>
                <button class="btn btn-success" onclick="testLogin()">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
                <div id="loginResult" class="result-box"></div>
            </div>

            <!-- Current User Status -->
            <div class="test-section">
                <h2><i class="fas fa-user"></i> 6. User Status</h2>
                <div id="userStatus">
                    <p style="color: #666;">Not logged in</p>
                </div>
                <button class="btn btn-secondary" onclick="checkUserStatus()" style="margin-top: 10px;">
                    <i class="fas fa-sync"></i> Refresh Status
                </button>
                <button class="btn btn-primary" onclick="testLogout()" style="margin-top: 10px;">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>
    </div>

    <script src="fast2sms-client.js"></script>
    <script>
        // Initialize Fast2SMS OTP Client
        const otpClient = new Fast2SMSOTPClient('http://localhost:3001');

        // Show result in a result box
        function showResult(elementId, type, title, message, data = null) {
            const resultBox = document.getElementById(elementId);
            resultBox.className = `result-box ${type}`;
            resultBox.style.display = 'block';

            const icon = type === 'success' ? 'check-circle' : type === 'error' ? 'times-circle' : 'info-circle';
            
            let html = `<h4><i class="fas fa-${icon}"></i> ${title}</h4><p>${message}</p>`;
            
            if (data) {
                html += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            }
            
            resultBox.innerHTML = html;
        }

        // Test Send OTP
        async function testSendOTP() {
            const phone = document.getElementById('sendPhone').value.trim();
            const type = document.getElementById('otpType').value;
            
            if (!phone) {
                showResult('sendResult', 'error', 'Error', 'Please enter a phone number');
                return;
            }

            try {
                showResult('sendResult', 'info', 'Sending...', 'Please wait while we send the OTP');
                const result = await otpClient.sendOTP(phone, type);
                showResult('sendResult', 'success', 'OTP Sent!', result.message, result);
            } catch (error) {
                showResult('sendResult', 'error', 'Failed', error.message);
            }
        }

        // Test Verify OTP
        async function testVerifyOTP() {
            const phone = document.getElementById('verifyPhone').value.trim();
            const otp = document.getElementById('otpCode').value.trim();
            
            if (!phone || !otp) {
                showResult('verifyResult', 'error', 'Error', 'Please enter phone number and OTP');
                return;
            }

            try {
                showResult('verifyResult', 'info', 'Verifying...', 'Please wait while we verify the OTP');
                const result = await otpClient.verifyOTP(phone, otp);
                showResult('verifyResult', 'success', 'Verified!', result.message, result);
            } catch (error) {
                showResult('verifyResult', 'error', 'Failed', error.message);
            }
        }

        // Test Resend OTP
        async function testResendOTP() {
            const phone = document.getElementById('resendPhone').value.trim();
            
            if (!phone) {
                showResult('resendResult', 'error', 'Error', 'Please enter a phone number');
                return;
            }

            try {
                showResult('resendResult', 'info', 'Resending...', 'Please wait while we resend the OTP');
                const result = await otpClient.resendOTP(phone);
                showResult('resendResult', 'success', 'OTP Resent!', result.message, result);
            } catch (error) {
                showResult('resendResult', 'error', 'Failed', error.message);
            }
        }

        // Test Register
        async function testRegister() {
            const name = document.getElementById('regName').value.trim();
            const phone = document.getElementById('regPhone').value.trim();
            const email = document.getElementById('regEmail').value.trim();
            const otp = document.getElementById('regOTP').value.trim();
            
            if (!name || !phone || !otp) {
                showResult('regResult', 'error', 'Error', 'Please fill in all required fields');
                return;
            }

            try {
                showResult('regResult', 'info', 'Registering...', 'Please wait while we register your account');
                const result = await otpClient.register({ name, phone, email, otp });
                showResult('regResult', 'success', 'Registered!', result.message, result);
                checkUserStatus();
            } catch (error) {
                showResult('regResult', 'error', 'Failed', error.message);
            }
        }

        // Test Login
        async function testLogin() {
            const phone = document.getElementById('loginPhone').value.trim();
            const otp = document.getElementById('loginOTP').value.trim();
            
            if (!phone || !otp) {
                showResult('loginResult', 'error', 'Error', 'Please enter phone number and OTP');
                return;
            }

            try {
                showResult('loginResult', 'info', 'Logging in...', 'Please wait while we log you in');
                const result = await otpClient.login(phone, otp);
                showResult('loginResult', 'success', 'Logged In!', result.message, result);
                checkUserStatus();
            } catch (error) {
                showResult('loginResult', 'error', 'Failed', error.message);
            }
        }

        // Check User Status
        function checkUserStatus() {
            const statusDiv = document.getElementById('userStatus');
            
            if (otpClient.isLoggedIn()) {
                const user = otpClient.getCurrentUser();
                statusDiv.innerHTML = `
                    <div style="background: #e8f5e9; padding: 15px; border-radius: 8px;">
                        <p style="color: #2e7d32; font-weight: 600; margin-bottom: 10px;">
                            <i class="fas fa-check-circle"></i> Logged In
                        </p>
                        <pre style="background: rgba(0,0,0,0.05); padding: 10px; border-radius: 5px; font-size: 12px;">${JSON.stringify(user, null, 2)}</pre>
                    </div>
                `;
            } else {
                statusDiv.innerHTML = '<p style="color: #666;"><i class="fas fa-times-circle"></i> Not logged in</p>';
            }
        }

        // Test Logout
        function testLogout() {
            otpClient.logout();
            checkUserStatus();
            alert('Logged out successfully!');
        }

        // Initialize
        checkUserStatus();
    </script>
</body>
</html>
