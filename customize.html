<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customize Your Frame - JB Creations</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        /* Header and Dropdown Styles - Matching Homepage */
        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .auth-section {
            display: flex;
            align-items: center;
        }

        .profile-dropdown {
            position: relative;
        }

        .profile-icon-btn {
            background: transparent;
            border: none;
            backdrop-filter: none;
            -webkit-backdrop-filter: none;
            box-shadow: none;
            color: #16697A;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 22px;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            min-width: 50px;
            text-align: center;
        }

        .profile-icon-btn:hover {
            background: rgba(22, 105, 122, 0.25);
            border: 1px solid rgba(22, 105, 122, 0.4);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            color: white;
        }

        .profile-icon-btn i {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            margin: 0;
            line-height: 1;
            font-size: 20px;
        }

        .profile-icon-btn .button-label {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            line-height: 1;
            margin: 0;
            width: 100%;
            text-align: center;
        }

        .profile-dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            min-width: 220px;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            margin-top: 10px;
            padding: 8px 0;
        }

        .profile-dropdown:hover .profile-dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .profile-dropdown-menu .dropdown-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            color: #333;
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
            border-radius: 8px;
            margin: 2px 8px;
        }

        .profile-dropdown-menu .dropdown-item:hover {
            background: linear-gradient(135deg, rgba(72, 159, 181, 0.1), rgba(72, 159, 181, 0.05));
            color: #489FB5;
            transform: translateX(5px);
        }

        .profile-dropdown-menu .dropdown-divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(72, 159, 181, 0.3), transparent);
            margin: 8px 16px;
        }

        /* User Info Section in Dropdown */
        .dropdown-user-info {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background: rgba(22, 105, 122, 0.05);
            border-radius: 8px;
            margin: 8px;
        }

        .dropdown-user-info .user-avatar {
            font-size: 24px;
            color: #16697A;
            margin-right: 12px;
        }

        .dropdown-user-info .user-details {
            flex: 1;
        }

        .dropdown-user-info .user-name {
            font-weight: 600;
            color: #16697A;
            font-size: 14px;
            margin-bottom: 2px;
        }

        .dropdown-user-info .user-phone {
            color: #489FB5;
            font-size: 12px;
        }

        /* Mobile Responsive Styles */
        @media (max-width: 600px) {
            .header-right {
                gap: 10px;
            }

            .profile-icon-btn {
                min-width: 40px;
                font-size: 18px;
                padding: 6px 8px;
                gap: 2px;
            }

            .profile-icon-btn .button-label {
                font-size: 9px;
            }

            .cart-icon-btn {
                min-width: 40px;
                font-size: 16px;
                padding: 6px 8px;
                gap: 2px;
            }

            .cart-icon-btn .button-label {
                font-size: 9px;
            }

            .profile-dropdown-menu {
                min-width: 200px;
                right: -10px;
            }

            .profile-dropdown-menu .dropdown-item {
                padding: 10px 16px;
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="site-header">
        <div class="header-content">
            <div class="header-left"></div>
            <div class="header-brand">
                <h1 class="brand-name">JB Creations</h1>
            </div>
            <div class="header-right">
                <div class="auth-section" id="authSection">
                    <!-- Profile dropdown button (always visible) -->
                    <div class="profile-dropdown" id="profileDropdown">
                        <button class="profile-icon-btn" id="profileBtn">
                            <i class="fas fa-user-alt"></i>
                            <span class="button-label">Profile</span>
                        </button>
                        <div class="profile-dropdown-menu" id="profileDropdownMenu">
                            <!-- Guest user options -->
                            <div class="guest-options" id="guestOptions">
                                <a href="otp-login.html?redirect=customize.html" class="dropdown-item">
                                    <i class="fas fa-sign-in-alt"></i>
                                    Sign In
                                </a>
                                <a href="otp-login.html?redirect=customize.html" class="dropdown-item">
                                    <i class="fas fa-user-plus"></i>
                                    Sign Up
                                </a>
                                <div class="dropdown-divider"></div>
                            </div>
                            
                            <!-- Authenticated user options (hidden by default) -->
                            <div class="authenticated-options" id="authenticatedOptions" style="display: none;">
                                <!-- User Info Section -->
                                <div class="dropdown-user-info" id="dropdownUserInfo">
                                    <div class="user-avatar">
                                        <i class="fas fa-user-circle"></i>
                                    </div>
                                    <div class="user-details">
                                        <div class="user-name" id="dropdownUserName">User</div>
                                        <div class="user-phone" id="dropdownUserPhone">Phone</div>
                                    </div>
                                </div>
                                <div class="dropdown-divider"></div>
                                
                                <a href="#" class="dropdown-item" onclick="viewProfile()">
                                    <i class="fas fa-user-circle"></i>
                                    My Profile
                                </a>
                                <a href="#" class="dropdown-item" onclick="viewOrders()">
                                    <i class="fas fa-box"></i>
                                    My Orders
                                </a>
                                <div class="dropdown-divider"></div>
                                <a href="#" class="dropdown-item" onclick="authUtils.logout()">
                                    <i class="fas fa-sign-out-alt"></i>
                                    Sign Out
                                </a>
                                <div class="dropdown-divider"></div>
                            </div>
                            
                            <!-- Common options for all users -->
                            <a href="track-order.html" class="dropdown-item">
                                <i class="fas fa-search"></i>
                                Track Order
                            </a>
                            <a href="#" class="dropdown-item" onclick="contactUs()">
                                <i class="fas fa-envelope"></i>
                                Contact Us
                            </a>
                            <a href="#" class="dropdown-item" onclick="aboutUs()">
                                <i class="fas fa-info-circle"></i>
                                About Us
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="header-cart">
                    <button class="cart-icon-btn" id="headerCartBtn" onclick="window.location.href='cart.html'">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-count" id="cartCount">0</span>
                        <span class="button-label">Cart</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        <!-- Left Side: Upload and Preview Section -->
        <div class="left-section">
            <!-- Upload Section -->
            <div class="upload-section" id="uploadSection">
                <div class="rain-glass">
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="water-droplet"></div>
                    <div class="water-droplet"></div>
                    <div class="water-droplet"></div>
                    <div class="water-droplet"></div>
                </div>
                <div class="upload-header">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <h2>Upload Your Image</h2>
                </div>
                <div class="frame" id="frame" data-size="13x19" data-orientation="portrait">
                    <div class="image-container" id="imageContainer">
                        <input type="file" id="imageUpload" accept="image/*" class="hidden-upload">
                        <div class="upload-overlay" id="uploadOverlay">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click here to upload your image</p>
                            <span class="upload-hint">or drag and drop</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Preview Section (Initially Hidden) -->
            <div class="preview-section hidden" id="previewSection">
                <div class="rain-glass">
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="water-droplet"></div>
                    <div class="water-droplet"></div>
                    <div class="water-droplet"></div>
                    <div class="water-droplet"></div>
                </div>
                <div class="preview-header">
                    <div class="preview-header-left">
                        <i class="fas fa-eye"></i>
                        <h2>Live Preview</h2>
                    </div>
                    <button id="changeImage" class="change-image-btn">
                        Change Image
                    </button>
                    <button id="updateRoomPreviews" class="change-image-btn" style="background: #82C0CC; margin-left: 10px;" onclick="updateRoomPreviewsClick()">
                        Update Room Previews
                    </button>
                </div>
                <div class="frame-preview" data-size="13x19" data-orientation="portrait">
                    <div class="frame-aspect-wrapper" data-size="13x19" data-orientation="portrait">
                        <div class="frame" data-size="13x19" data-orientation="portrait">
                            <div class="image-container">
                                <img id="previewImage" class="preview-image">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="preview-controls">
                    <div class="control-buttons">
                        <div class="zoom-controls">
                            <button id="zoomOut" title="Zoom Out (Large Step)"><i class="fas fa-minus"></i></button>
                            <button id="precisionZoomOut" class="precision-zoom" title="Precision Zoom Out (Fine Step)"><i class="fas fa-minus"></i></button>
                            <button id="precisionZoomIn" class="precision-zoom" title="Precision Zoom In (Fine Step)"><i class="fas fa-plus"></i></button>
                            <button id="zoomIn" title="Zoom In (Large Step)"><i class="fas fa-plus"></i></button>
                            <!-- Mobile-only change image button that overlays the pseudo-element -->
                            <button id="mobileChangeImage" class="mobile-change-image-btn" title="Change Image">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                    </div>
                    <!-- Mobile buttons for touch devices -->
                    <div class="mobile-controls">
                        <button class="mobile-zoom-btn mobile-zoom-out" title="Zoom Out">
                            <i class="fas fa-minus"></i>
                        </button>
                        <button class="mobile-zoom-btn mobile-precision-zoom-out" title="Precision Zoom Out">
                            <i class="fas fa-minus"></i>
                        </button>
                        <button class="mobile-zoom-btn mobile-precision-zoom-in" title="Precision Zoom In">
                            <i class="fas fa-plus"></i>
                        </button>
                        <button class="mobile-zoom-btn mobile-zoom-in" title="Zoom In">
                            <i class="fas fa-plus"></i>
                        </button>
                        <button class="mobile-change-btn" onclick="document.getElementById('imageUpload').click()" title="Change Image">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Middle Section: Customization Cards -->
        <div class="middle-section">
            <div class="desktop-customization-section">
                <div class="desktop-customization-header">
                    <i class="fas fa-palette"></i>
                    <h2>Customize Your Frame</h2>
                </div>
                
                <!-- Desktop Compact Customization Cards -->
                <div class="desktop-customization-cards">
                    <div class="cards-container" id="cardsContainer">
                        <!-- Size Card -->
                        <div class="desktop-card active" data-type="size">
                            <div class="desktop-card-header">
                                <i class="fas fa-ruler-combined"></i>
                                <span>Size</span>
                            </div>
                            <div class="desktop-card-content">
                                <div class="desktop-size-grid">
                                    <button class="desktop-size-btn" data-size="13x19" data-orientation="portrait" data-price="349">
                                        <i class="fas fa-portrait"></i>
                                        <div class="size-info">
                                            <span class="size-text">13×19"</span>
                                            <span class="orientation">Portrait</span>
                                            <span class="price">₹349</span>
                                        </div>
                                    </button>
                                    <button class="desktop-size-btn" data-size="13x19" data-orientation="landscape" data-price="349">
                                        <i class="fas fa-image"></i>
                                        <div class="size-info">
                                            <span class="size-text">13×19"</span>
                                            <span class="orientation">Landscape</span>
                                            <span class="price">₹349</span>
                                        </div>
                                    </button>
                                    <button class="desktop-size-btn" data-size="13x10" data-orientation="portrait" data-price="249">
                                        <i class="fas fa-portrait"></i>
                                        <div class="size-info">
                                            <span class="size-text">13×10"</span>
                                            <span class="orientation">Portrait</span>
                                            <span class="price">₹249</span>
                                        </div>
                                    </button>
                                    <button class="desktop-size-btn" data-size="13x10" data-orientation="landscape" data-price="249">
                                        <i class="fas fa-image"></i>
                                        <div class="size-info">
                                            <span class="size-text">13×10"</span>
                                            <span class="orientation">Landscape</span>
                                            <span class="price">₹249</span>
                                        </div>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Color Card -->
                        <div class="desktop-card" data-type="color">
                            <div class="desktop-card-header">
                                <i class="fas fa-fill-drip"></i>
                                <span>Color</span>
                            </div>
                            <div class="desktop-card-content">
                                <div class="desktop-color-grid">
                                    <button class="desktop-color-btn" data-color="black">
                                        <div class="color-preview black-preview"></div>
                                        <span>Black</span>
                                    </button>
                                    <button class="desktop-color-btn" data-color="white">
                                        <div class="color-preview white-preview"></div>
                                        <span>White</span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Texture Card -->
                        <div class="desktop-card" data-type="texture">
                            <div class="desktop-card-header">
                                <i class="fas fa-texture"></i>
                                <span>Texture</span>
                            </div>
                            <div class="desktop-card-content">
                                <div class="desktop-texture-grid">
                                    <button class="desktop-texture-btn" data-texture="smooth">
                                        <i class="fas fa-grip-lines"></i>
                                        <span>Smooth</span>
                                    </button>
                                    <button class="desktop-texture-btn" data-texture="rough">
                                        <i class="fas fa-grip-lines-vertical"></i>
                                        <span>Rough</span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Adjustments Card -->
                        <div class="desktop-card" data-type="adjustments">
                            <div class="desktop-card-header">
                                <i class="fas fa-sliders-h"></i>
                                <span>Adjust</span>
                            </div>
                            <div class="desktop-card-content">
                                <div class="desktop-adjustments-container">
                                    <div class="desktop-adjustment-item">
                                        <i class="fas fa-sun"></i>
                                        <span>Brightness</span>
                                        <input type="range" id="brightness" min="0" max="200" value="100">
                                    </div>
                                    <div class="desktop-adjustment-item">
                                        <i class="fas fa-adjust"></i>
                                        <span>Contrast</span>
                                        <input type="range" id="contrast" min="0" max="200" value="100">
                                    </div>
                                    <div class="desktop-adjustment-item">
                                        <i class="fas fa-lightbulb"></i>
                                        <span>Highlights</span>
                                        <input type="range" id="highlights" min="0" max="200" value="100">
                                    </div>
                                    <div class="desktop-adjustment-item">
                                        <i class="fas fa-moon"></i>
                                        <span>Shadows</span>
                                        <input type="range" id="shadows" min="0" max="200" value="100">
                                    </div>
                                    <div class="desktop-adjustment-item">
                                        <i class="fas fa-paint-brush"></i>
                                        <span>Vibrance</span>
                                        <input type="range" id="vibrance" min="0" max="200" value="100">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Navigation Bar -->
            <div class="navigation-bar">
                <div class="card-indicators-section">
                    <button class="card-nav-btn prev-card-btn" id="prevCardBtn" disabled>
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    
                    <div class="card-indicators">
                        <div class="card-dot active" data-card="0"></div>
                        <div class="card-dot" data-card="1"></div>
                        <div class="card-dot" data-card="2"></div>
                        <div class="card-dot" data-card="3"></div>
                    </div>
                    
                    <button class="card-nav-btn next-card-btn" id="nextCardBtn">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
            
            <!-- Total Price Bar -->
            <div class="total-price-bar">
                <div class="bottom-bar-content">
                    <div class="price-and-cart">
                        <div class="total-price-section">
                            <i class="fas fa-tag"></i>
                            <span class="price-label">Total:</span>
                            <span class="price-value" id="totalPrice">₹0</span>
                        </div>
                        <button id="addToCart" class="floating-cart-btn" disabled>
                            <i class="fas fa-shopping-cart"></i>
                            <span>Add to Cart</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Section: Room Preview Section -->
        <div class="right-section">
            <div class="room-preview-section">
                <div class="rain-glass">
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="raindrop"></div>
                    <div class="water-droplet"></div>
                    <div class="water-droplet"></div>
                    <div class="water-droplet"></div>
                    <div class="water-droplet"></div>
                </div>
                <div class="preview-header">
                    <div class="preview-header-left">
                        <i class="fas fa-home"></i>
                        <h2>Room Preview</h2>
                    </div>
                </div>
                <div class="room-preview-container">
                    <!-- Default room preview image (shown when no frame size is selected) -->
                    <img src="Room-previewbackground.png" alt="Room Preview" class="room-preview-image default-preview" id="defaultRoomPreview">
                    
                    <!-- Frame-specific room preview slider (hidden by default) -->
                    <div class="room-slider-container" id="roomSliderContainer" style="display: none;">
                        <div class="room-slider" id="roomSlider">
                            <!-- Images will be dynamically loaded here -->
                        </div>
                    </div>
                </div>
                
                <!-- Room Preview Navigation Bar -->
                <div class="room-navigation-bar">
                    <div class="room-indicators-section">
                        <button class="room-nav-btn prev" id="roomSliderPrev" title="Previous image">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        
                        <div class="room-indicators" id="sliderIndicators">
                            <!-- Dots will be dynamically added here -->
                        </div>
                        
                        <button class="room-nav-btn next" id="roomSliderNext" title="Next image">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>
            </div>
        </div>

        <!-- Mobile Customization Section -->
        <div class="mobile-customization-section" id="mobileCustomizationSection">
            <div class="mobile-customization-header">
                <i class="fas fa-palette"></i>
                <h2>Customize Your Frame</h2>
            </div>
            
            <!-- Mobile Compact Customization Cards -->
            <div class="mobile-customization-cards" id="mobileCustomizationCards">
                <!-- Size Card -->
                <div class="mobile-card" data-type="size">
                    <div class="mobile-card-header">
                        <i class="fas fa-ruler-combined"></i>
                        <span>Size</span>
                    </div>
                    <div class="mobile-card-content">
                        <div class="mobile-size-grid">
                            <button class="mobile-size-btn" data-size="13x19" data-orientation="portrait" data-price="349">
                                <i class="fas fa-portrait"></i>
                                <div class="size-info">
                                    <span class="size-text">13×19"</span>
                                    <span class="orientation">Portrait</span>
                                    <span class="price">₹349</span>
                                </div>
                            </button>
                            <button class="mobile-size-btn" data-size="13x19" data-orientation="landscape" data-price="349">
                                <i class="fas fa-image"></i>
                                <div class="size-info">
                                    <span class="size-text">13×19"</span>
                                    <span class="orientation">Landscape</span>
                                    <span class="price">₹349</span>
                                </div>
                            </button>
                            <button class="mobile-size-btn" data-size="13x10" data-orientation="portrait" data-price="249">
                                <i class="fas fa-portrait"></i>
                                <div class="size-info">
                                    <span class="size-text">13×10"</span>
                                    <span class="orientation">Portrait</span>
                                    <span class="price">₹249</span>
                                </div>
                            </button>
                            <button class="mobile-size-btn" data-size="13x10" data-orientation="landscape" data-price="249">
                                <i class="fas fa-image"></i>
                                <div class="size-info">
                                    <span class="size-text">13×10"</span>
                                    <span class="orientation">Landscape</span>
                                    <span class="price">₹249</span>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Color Card -->
                <div class="mobile-card" data-type="color">
                    <div class="mobile-card-header">
                        <i class="fas fa-fill-drip"></i>
                        <span>Color</span>
                    </div>
                    <div class="mobile-card-content">
                        <div class="mobile-color-grid">
                            <button class="mobile-color-btn" data-color="black">
                                <div class="color-preview black-preview"></div>
                                <span>Black</span>
                            </button>
                            <button class="mobile-color-btn" data-color="white">
                                <div class="color-preview white-preview"></div>
                                <span>White</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Texture Card -->
                <div class="mobile-card" data-type="texture">
                    <div class="mobile-card-header">
                        <i class="fas fa-texture"></i>
                        <span>Texture</span>
                    </div>
                    <div class="mobile-card-content">
                        <div class="mobile-texture-grid">
                            <button class="mobile-texture-btn" data-texture="smooth">
                                <i class="fas fa-grip-lines"></i>
                                <span>Smooth</span>
                            </button>
                            <button class="mobile-texture-btn" data-texture="rough">
                                <i class="fas fa-grip-lines-vertical"></i>
                                <span>Rough</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Adjustments Card -->
                <div class="mobile-card" data-type="adjustments">
                    <div class="mobile-card-header">
                        <i class="fas fa-sliders-h"></i>
                        <span>Adjust</span>
                    </div>
                    <div class="mobile-card-content">
                        <div class="mobile-adjustments-container">
                            <div class="mobile-adjustment-item">
                                <i class="fas fa-sun"></i>
                                <input type="range" id="mobileBrightness" min="0" max="200" value="100">
                            </div>
                            <div class="mobile-adjustment-item">
                                <i class="fas fa-adjust"></i>
                                <input type="range" id="mobileContrast" min="0" max="200" value="100">
                            </div>
                            <div class="mobile-adjustment-item">
                                <i class="fas fa-lightbulb"></i>
                                <input type="range" id="mobileHighlights" min="0" max="200" value="100">
                            </div>
                            <div class="mobile-adjustment-item">
                                <i class="fas fa-moon"></i>
                                <input type="range" id="mobileShadows" min="0" max="200" value="100">
                            </div>
                            <div class="mobile-adjustment-item">
                                <i class="fas fa-paint-brush"></i>
                                <input type="range" id="mobileVibrance" min="0" max="200" value="100">
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Firebase Backend Integration -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script type="module" src="firebase-client-new.js?v=3"></script>
    <script src="otp-auth-firebase.js"></script>
    <script src="auth.js"></script>
    <script src="script.js"></script>
    <script>
        // Profile dropdown functionality
        document.addEventListener('DOMContentLoaded', async function() {
            // Profile dropdown is now handled by CSS hover - no JavaScript needed
            
            // Check authentication status
            await checkAuthStatus();
        });

        // Get current authenticated user from Firebase
        async function getCurrentAuthenticatedUser() {
            try {
                // Wait for Firebase to be ready with retry mechanism
                const maxRetries = 5; // Reduced from 10 since we now have the proper scripts
                for (let i = 0; i < maxRetries; i++) {
                    if (typeof window.otpAuth !== 'undefined') {
                        console.log('📱 Getting current user from Firebase...');
                        const user = await window.otpAuth.getCurrentUser();
                        console.log('📱 Firebase user result:', user);
                        return user;
                    } else {
                        console.log(`⏳ Firebase not ready yet, retrying... (${i + 1}/${maxRetries})`);
                        await new Promise(resolve => setTimeout(resolve, 300)); // Reduced from 500ms
                    }
                }
                
                console.log('❌ OTP Auth system not available after retries, falling back to localStorage');
                // Fallback to localStorage if Firebase is not available after retries
                const userDataStr = localStorage.getItem('jb_current_user');
                if (!userDataStr) return null;
                
                try {
                    return JSON.parse(userDataStr);
                } catch (parseError) {
                    console.log('Failed to parse user data as JSON, might be old format:', userDataStr);
                    if (userDataStr.startsWith('+91') || userDataStr.startsWith('+')) {
                        return { phone: userDataStr, name: 'User' };
                    }
                    return null;
                }
            } catch (error) {
                console.error('❌ Error getting current user from Firebase:', error);
                return null;
            }
        }

        // Check if user is authenticated and update UI accordingly
        async function checkAuthStatus() {
            try {
                const user = await getCurrentAuthenticatedUser();
                console.log('📱 checkAuthStatus - user found:', user);
                
                const guestOptions = document.getElementById('guestOptions');
                const authenticatedOptions = document.getElementById('authenticatedOptions');
                
                if (user && user.phone) {
                    console.log('📱 checkAuthStatus - user name:', user.name);
                    console.log('📱 checkAuthStatus - user phone:', user.phone);
                    
                    // User is logged in
                    if (guestOptions) guestOptions.style.display = 'none';
                    if (authenticatedOptions) authenticatedOptions.style.display = 'block';
                    
                    // Update user info in dropdown
                    const dropdownUserName = document.getElementById('dropdownUserName');
                    const dropdownUserPhone = document.getElementById('dropdownUserPhone');
                    
                    if (dropdownUserName) {
                        dropdownUserName.textContent = user.name || 'User';
                        console.log('📱 checkAuthStatus - Set dropdown name to:', user.name || 'User');
                    }
                    if (dropdownUserPhone) {
                        dropdownUserPhone.textContent = user.phone || 'Phone not available';
                    }
                } else {
                    showGuestState();
                }
                
                // Also call updateAuthUI for consistency with homepage
                await updateAuthUI();
            } catch (error) {
                console.log('Auth check error:', error);
                showGuestState();
            }
        }

        function showGuestState() {
            // Default to guest state
            const guestOptions = document.getElementById('guestOptions');
            const authenticatedOptions = document.getElementById('authenticatedOptions');
            if (guestOptions) guestOptions.style.display = 'block';
            if (authenticatedOptions) authenticatedOptions.style.display = 'none';
        }

        // Sign out function
        function signOut() {
            if (confirm('Are you sure you want to sign out?')) {
                localStorage.removeItem('jb_current_user');
                localStorage.removeItem('jb_users');
                window.location.reload();
            }
        }
        
        // Update authentication UI based on login status
        async function updateAuthUI() {
            try {
                const user = await getCurrentAuthenticatedUser();
                console.log('📱 updateAuthUI - user found:', user);
                
                const guestOptions = document.getElementById('guestOptions');
                const authenticatedOptions = document.getElementById('authenticatedOptions');
                const profileBtn = document.getElementById('profileBtn');
                
                if (user) {
                    console.log('📱 updateAuthUI - user name:', user.name);
                    console.log('📱 updateAuthUI - user phone:', user.phone);
                    
                    // User is logged in - show authenticated options, hide guest options
                    if (guestOptions) {
                        guestOptions.style.display = 'none';
                    }
                    if (authenticatedOptions) {
                        authenticatedOptions.style.display = 'block';
                    }
                    
                    // Update user info in dropdown
                    const dropdownUserName = document.getElementById('dropdownUserName');
                    const dropdownUserPhone = document.getElementById('dropdownUserPhone');
                    
                    if (dropdownUserName) {
                        dropdownUserName.textContent = user.name || 'User';
                        console.log('📱 updateAuthUI - Set dropdown name to:', user.name || 'User');
                    }
                    if (dropdownUserPhone) {
                        dropdownUserPhone.textContent = user.phone || 'Phone not available';
                    }
                    
                    // Always keep profile button text as "Profile"
                    if (profileBtn) {
                        profileBtn.innerHTML = `
                            <i class="fas fa-user-alt"></i>
                            <span class="button-label">Profile</span>
                        `;
                        profileBtn.style.color = '#16697A';
                    }
                } else {
                    // User is not logged in - show guest options, hide authenticated options
                    if (guestOptions) {
                        guestOptions.style.display = 'block';
                    }
                    if (authenticatedOptions) {
                        authenticatedOptions.style.display = 'none';
                    }
                    
                    // Reset profile button to default
                    if (profileBtn) {
                        profileBtn.innerHTML = `
                            <i class="fas fa-user-alt"></i>
                            <span class="button-label">Profile</span>
                        `;
                    }
                }
            } catch (error) {
                console.error('❌ Error updating auth UI:', error);
            }
        }
        
        // View user profile / toggle dropdown
        async function viewProfile() {
            const dropdown = document.getElementById('profileDropdownMenu');
            if (dropdown) {
                dropdown.style.opacity = dropdown.style.opacity === '1' ? '0' : '1';
                dropdown.style.visibility = dropdown.style.visibility === 'visible' ? 'hidden' : 'visible';
                dropdown.style.transform = dropdown.style.opacity === '1' ? 'translateY(0)' : 'translateY(-10px)';
            }
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('profileDropdownMenu');
            const profileBtn = document.getElementById('profileBtn');
            
            if (dropdown && profileBtn && !profileBtn.contains(event.target) && !dropdown.contains(event.target)) {
                dropdown.style.opacity = '0';
                dropdown.style.visibility = 'hidden';
                dropdown.style.transform = 'translateY(-10px)';
            }
        });

        // View user orders
        function viewOrders() {
            window.location.href = 'my-orders.html';
        }
        
        // Contact us function
        function contactUs() {
            alert('Contact Us\n\nEmail: contact@jbcreations.com\nPhone: +91 12345 67890\nAddress: 123 Art Street, Creative City, India\n\nWe\'d love to hear from you!');
        }

        // About us function
        function aboutUs() {
            alert('About JB Creations\n\nWe are passionate about turning your precious memories into beautiful wall art. With years of experience in custom photo framing, we use premium materials and professional craftsmanship to create frames that last a lifetime.\n\nOur mission is to help you showcase your most cherished moments in style.');
        }
    </script>

    <!-- Professional Footer -->
    <footer class="footer">
        <div class="footer-content">
            <!-- Column 1: Company Info -->
            <div class="footer-column">
                <a href="index.html" class="footer-logo">JB Creations</a>
                <div class="footer-tagline">Custom Photo Frames & Memories</div>
                <p class="footer-description">
                    We are passionate about turning your precious memories into beautiful wall art. With premium materials and professional craftsmanship, we create frames that last a lifetime and showcase your most cherished moments in style.
                </p>
            </div>

            <!-- Column 2: Quick Links -->
            <div class="footer-column">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="customize.html">Our Services</a></li>
                    <li><a href="#gallery">Gallery</a></li>
                    <li><a href="customize.html">Custom Orders</a></li>
                    <li><a href="#" onclick="aboutUs(); return false;">About Us</a></li>
                    <li><a href="#" onclick="contactUs(); return false;">Contact</a></li>
                </ul>
            </div>

            <!-- Column 3: Services -->
            <div class="footer-column">
                <h3>Our Services</h3>
                <ul class="footer-links">
                    <li><a href="customize.html">Custom Photo Frames</a></li>
                    <li><a href="customize.html">Wood Frames</a></li>
                    <li><a href="customize.html">Metal Frames</a></li>
                    <li><a href="customize.html">Digital Printing</a></li>
                    <li><a href="#" onclick="contactUs(); return false;">Frame Repair</a></li>
                    <li><a href="#" onclick="contactUs(); return false;">Bulk Orders</a></li>
                </ul>
            </div>

            <!-- Column 4: Contact Info -->
            <div class="footer-column">
                <h3>Get In Touch</h3>
                <div class="contact-item">
                    <i class="fas fa-phone contact-icon"></i>
                    <div class="contact-text">
                        <strong>Call Us</strong>
                        +91 98765 43210
                    </div>
                </div>
                <div class="contact-item">
                    <i class="fas fa-envelope contact-icon"></i>
                    <div class="contact-text">
                        <strong>Email Us</strong>
                        info@jbcreations.com
                    </div>
                </div>
                <div class="contact-item">
                    <i class="fas fa-map-marker-alt contact-icon"></i>
                    <div class="contact-text">
                        <strong>Visit Us</strong>
                        123 Art Street, Creative City, India 400001
                    </div>
                </div>
                
                <!-- Social Media Links -->
                <div class="social-links">
                    <a href="https://facebook.com/jbcreations" class="social-icon" target="_blank" title="Follow us on Facebook">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="https://instagram.com/jbcreations" class="social-icon" target="_blank" title="Follow us on Instagram">
                        <i class="fab fa-instagram"></i>
                    </a>
                    <a href="https://wa.me/919876543210" class="social-icon" target="_blank" title="Chat with us on WhatsApp">
                        <i class="fab fa-whatsapp"></i>
                    </a>
                </div>
            </div>
        </div>

        <!-- Footer Bottom Section -->
        <div class="footer-bottom">
            <div class="footer-bottom-content">
                <div class="copyright">
                    © 2024 JB Creations. All rights reserved.
                </div>
                <div class="footer-bottom-links">
                    <a href="#privacy-policy">Privacy Policy</a>
                    <a href="#terms-conditions">Terms & Conditions</a>
                    <div class="designed-by">
                        Designed with <span class="heart">❤️</span> by JB Creations
                    </div>
                </div>
            </div>
        </div>
    </footer>

</body>
</html>
